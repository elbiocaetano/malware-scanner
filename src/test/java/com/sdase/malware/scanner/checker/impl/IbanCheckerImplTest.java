package com.sdase.malware.scanner.checker.impl;

import static org.junit.jupiter.api.Assertions.assertEquals;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.CsvSource;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

@SpringBootTest
class IbanCheckerImplTest {
	
	private static final String IBAN_CHECKER = "iban-checker";
	
	@Autowired
	private IbanChecker ibanChecker;
	
	@ParameterizedTest
    @CsvSource({
        "a string without iban number, IGNORED, This file does not have an IBAN number",
        "DE89 3704 0044 0532 0130 00, SUSPICIOUS, This IBAN code is on blacklist",
        "DE89370400440532013000, SUSPICIOUS, This IBAN code is on blacklist",
        "CE89370400440532013000, OK, This file has a valid IBAN code",
    })
	void checkIbanCodeTest(String ibanCode, String state, String details) {
		var response = ibanChecker.check(ibanCode);
		assertEquals(state, response.getState().name());
		assertEquals(details, response.getDetails());
		assertEquals(IBAN_CHECKER, response.getName());
	}

}
