package com.sdase.malware.scanner.utils;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

import com.sdase.malware.scanner.entity.CheckRequest;
import com.sdase.malware.scanner.streaming.model.CheckEvent;
import com.sdase.malware.scanner.streaming.model.CheckResultEvent;
import com.sdase.malware.scanner.streaming.model.CheckResultEvent.StateEnum;

public final class TestUtils {
	public static CheckRequest buildCheckRequest(List<CheckResultEvent> events) {
		var checkRequest = new CheckRequest();
		checkRequest.setId("abcdefg");
		checkRequest.setContent("content");
		checkRequest.setFinishedAt(LocalDateTime.now());
		checkRequest.setRequestedAt(LocalDateTime.now());
		checkRequest.setResults(events);
		return checkRequest;
	}

	public static CheckEvent buildCheckEvent(String url) {
		var event = new CheckEvent();
		event.setUrl(url);
		event.setFileType("pdf");
		return event;
	}

	public static List<CheckResultEvent> buildCheckResultEvents() {
		List<CheckResultEvent> response = new ArrayList<>();
		response.add(new CheckResultEvent(StateEnum.OK, "iban-checker", "This file has a valid IBAN code"));
		response.add(new CheckResultEvent(StateEnum.ERROR, "other-checker", "This file has an error"));
		return response;
	}
}
